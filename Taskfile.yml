version: "3"

tasks:
  # é–‹ç™ºãƒ¢ãƒ¼ãƒ‰
  dev:
    desc: WebUIï¼ˆãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼‰ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆWailsãªã—ï¼‰
    cmds:
      - task: dev:webui

  dev:quick:
    desc: ã‚¯ã‚¤ãƒƒã‚¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼ˆGoã®ã¿ã€distãƒ“ãƒ«ãƒ‰æ¸ˆã¿å‰æï¼‰
    cmds:
      - |
        echo "ğŸš€ Webã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ä¸­..."
        go run ./cmd/server

  dev:wails:
    desc: é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ï¼ˆWails/ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã€OBSç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚‚åŒæ™‚ãƒ“ãƒ«ãƒ‰ï¼‰
    cmds:
      - |
        echo "ğŸ“¦ OBSç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        (cd web && bun run build)

        echo "ğŸ“¦ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        (cd frontend && bun run build)

        echo "ğŸ”¨ Goãƒã‚¤ãƒŠãƒªã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        go build -o build/bin/twitch-overlay

        echo "ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ä¸­..."
        echo "ğŸ’¡ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¤‰æ›´æ™‚: å†èµ·å‹•ãŒå¿…è¦"
        echo "ğŸ’¡ ã‚ˆã‚Šæ—©ã„é–‹ç™º: 'task dev:wails:quick'ï¼ˆGoãƒ“ãƒ«ãƒ‰ã®ã¿ï¼‰"
        if [ "$(uname)" = "Darwin" ]; then
          echo "ğŸ“¦ macOS: devç”¨.appã‚’ä½œæˆä¸­..."
          APP_DIR="build/bin/twitch-overlay.dev.app"
          mkdir -p "$APP_DIR/Contents/MacOS" "$APP_DIR/Contents/Resources"
          cp build/bin/twitch-overlay "$APP_DIR/Contents/MacOS/twitch-overlay"
          cp build/darwin/Info.plist "$APP_DIR/Contents/Info.plist"
          /usr/libexec/PlistBuddy -c "Set :CFBundleIdentifier com.ichi0g0y.twitch-overlay.dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleName Twitch Overlay Dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleExecutable twitch-overlay" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          codesign --force --deep --sign - --entitlements build/darwin/entitlements.plist "$APP_DIR"
          # LaunchServicesçµŒç”±ã§èµ·å‹•ã—ãªã„ã¨macOSã§SIGABRTã™ã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚openã‚’ä½¿ç”¨ã™ã‚‹
          pkill -f "twitch-overlay.dev.app/Contents/MacOS/twitch-overlay" >/dev/null 2>&1 || true
          open -n "$APP_DIR"
          echo "âœ… èµ·å‹•ã—ã¾ã—ãŸ: $APP_DIR"
          echo "ğŸ’¡ çµ‚äº†: ã‚¢ãƒ—ãƒªã‹ã‚‰Quitã€ã¾ãŸã¯ 'pkill -f twitch-overlay.dev.app/Contents/MacOS/twitch-overlay'"
        else
          ./build/bin/twitch-overlay
        fi

  dev:wails:quick:
    desc: ã‚¯ã‚¤ãƒƒã‚¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ï¼ˆWails/ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã€Goå†ãƒ“ãƒ«ãƒ‰ã®ã¿ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ“ãƒ«ãƒ‰æ¸ˆã¿å‰æï¼‰
    cmds:
      - |
        echo "ğŸ”¨ Goãƒã‚¤ãƒŠãƒªã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        go build -o build/bin/twitch-overlay

        echo "ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ä¸­..."
        if [ "$(uname)" = "Darwin" ]; then
          APP_DIR="build/bin/twitch-overlay.dev.app"
          mkdir -p "$APP_DIR/Contents/MacOS" "$APP_DIR/Contents/Resources"
          cp build/bin/twitch-overlay "$APP_DIR/Contents/MacOS/twitch-overlay"
          cp build/darwin/Info.plist "$APP_DIR/Contents/Info.plist"
          /usr/libexec/PlistBuddy -c "Set :CFBundleIdentifier com.ichi0g0y.twitch-overlay.dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleName Twitch Overlay Dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleExecutable twitch-overlay" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          codesign --force --deep --sign - --entitlements build/darwin/entitlements.plist "$APP_DIR"
          pkill -f "twitch-overlay.dev.app/Contents/MacOS/twitch-overlay" >/dev/null 2>&1 || true
          open -n "$APP_DIR"
          echo "âœ… èµ·å‹•ã—ã¾ã—ãŸ: $APP_DIR"
          echo "ğŸ’¡ çµ‚äº†: ã‚¢ãƒ—ãƒªã‹ã‚‰Quitã€ã¾ãŸã¯ 'pkill -f twitch-overlay.dev.app/Contents/MacOS/twitch-overlay'"
        else
          ./build/bin/twitch-overlay
        fi

  dev:webui:
    desc: WebUIï¼ˆãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ï¼‰ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆWailsãªã—ï¼‰
    cmds:
      - |
        # Wails devã‚¢ãƒ—ãƒªãŒèµ·å‹•ä¸­ã ã¨ãƒãƒ¼ãƒˆç«¶åˆã™ã‚‹ãŸã‚åœæ­¢
        if [ "$(uname)" = "Darwin" ]; then
          pkill -f "twitch-overlay.dev.app/Contents/MacOS/twitch-overlay" >/dev/null 2>&1 || true
          # æ—¢å­˜ã®WebUI(dev)ã‚µãƒ¼ãƒãƒ¼ã‚‚åœæ­¢ï¼ˆãƒãƒ¼ãƒˆç«¶åˆå›é¿ï¼‰
          pkill -f "twitch-overlay-webui.dev.app/Contents/MacOS/twitch-overlay-webui-server" >/dev/null 2>&1 || true
        fi

        echo "ğŸ“¦ ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        (cd web && bun run build)

        echo "ğŸ“¦ WebUIã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
        (cd frontend && bun run build)

        # macOS: CoreBluetoothã¯CLIèµ·å‹•ã ã¨abort trapã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€.appãƒãƒ³ãƒ‰ãƒ«ã§èµ·å‹•ã™ã‚‹
        if [ "$(uname)" = "Darwin" ]; then
          echo "ğŸ”¨ Go(ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹)ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
          mkdir -p build/bin
          go build -o build/bin/twitch-overlay-webui-server ./cmd/server

          echo "ğŸ“¦ macOS: WebUIç”¨.dev.appã‚’ä½œæˆä¸­..."
          APP_DIR="build/bin/twitch-overlay-webui.dev.app"
          mkdir -p "$APP_DIR/Contents/MacOS" "$APP_DIR/Contents/Resources"
          cp build/bin/twitch-overlay-webui-server "$APP_DIR/Contents/MacOS/twitch-overlay-webui-server"
          cp build/darwin/Info.plist "$APP_DIR/Contents/Info.plist"
          /usr/libexec/PlistBuddy -c "Set :CFBundleIdentifier com.ichi0g0y.twitch-overlay.webui.dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleName Twitch Overlay WebUI Dev" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true
          /usr/libexec/PlistBuddy -c "Set :CFBundleExecutable twitch-overlay-webui-server" "$APP_DIR/Contents/Info.plist" >/dev/null 2>&1 || true

          echo "ğŸ“¦ ã‚¢ã‚»ãƒƒãƒˆã‚’åŒæ¢±ä¸­..."
          mkdir -p "$APP_DIR/Contents/Resources/web" "$APP_DIR/Contents/Resources/frontend"
          rsync -av --delete web/dist/ "$APP_DIR/Contents/Resources/web/dist/"
          rsync -av --delete frontend/dist/ "$APP_DIR/Contents/Resources/frontend/dist/"

          echo "ğŸ” ç½²åå‡¦ç†ä¸­ï¼ˆã‚¨ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ãƒ¡ãƒ³ãƒˆé©ç”¨ï¼‰..."
          codesign --force --deep --sign - --entitlements build/darwin/entitlements.plist "$APP_DIR"

          # æ—¢å­˜ãƒ—ãƒ­ã‚»ã‚¹ãŒæ®‹ã£ã¦ã„ã‚‹ã¨ãƒãƒ¼ãƒˆç«¶åˆã™ã‚‹ãŸã‚åœæ­¢
          pkill -f "twitch-overlay-webui.dev.app/Contents/MacOS/twitch-overlay-webui-server" >/dev/null 2>&1 || true
          open -n "$APP_DIR"
          # PORTæ¤œå‡ºã¯DBä¾å­˜ã«ã™ã‚‹ã¨å¤±æ•—ã—ãŒã¡ãªã®ã§ã€devã¯ENVå„ªå…ˆã§å›ºå®šå€¤ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹
          PORT="${SERVER_PORT:-30303}"
          echo "â³ èµ·å‹•ç¢ºèªä¸­... http://localhost:$PORT/"
          for i in {1..20}; do
            if curl -fsS "http://localhost:$PORT/" >/dev/null 2>&1; then
              echo "âœ… WebUI OK: http://localhost:$PORT/"
              break
            fi
            sleep 0.25
          done
          echo "âœ… èµ·å‹•ã—ã¾ã—ãŸ: $APP_DIR"
          echo "ğŸ’¡ çµ‚äº†: ã‚¢ãƒ—ãƒªã‹ã‚‰Quitã€ã¾ãŸã¯ 'pkill -f twitch-overlay-webui.dev.app/Contents/MacOS/twitch-overlay-webui-server'"
        else
          echo "ğŸš€ Webã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ä¸­..."
          go run ./cmd/server
        fi

  # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰
  build:
    desc: ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œ
    cmds:
      - echo "OBSç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
      - cd web && bun run build
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
      - cd frontend && bun install
      - echo "ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆä¸­..."
      - wails3 generate bindings -clean=true
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
      - cd frontend && bun run build
      - echo ".appãƒãƒ³ãƒ‰ãƒ«ã‚’ä½œæˆä¸­..."
      - mkdir -p build/bin/twitch-overlay.app/Contents/MacOS
      - mkdir -p build/bin/twitch-overlay.app/Contents/Resources
      - echo "Goãƒã‚¤ãƒŠãƒªã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
      - go build -tags production -ldflags "-w -s" -o build/bin/twitch-overlay.app/Contents/MacOS/twitch-overlay
      - echo "Info.plistã‚’ã‚³ãƒ”ãƒ¼ä¸­..."
      - cp build/darwin/Info.plist build/bin/twitch-overlay.app/Contents/
      - echo "ç½²åå‡¦ç†ä¸­ï¼ˆã‚¨ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ãƒ¡ãƒ³ãƒˆé©ç”¨ï¼‰..."
      - codesign --force --deep --sign - --entitlements build/darwin/entitlements.plist build/bin/twitch-overlay.app
      - echo "ãƒ“ãƒ«ãƒ‰å®Œäº† â†’ build/bin/twitch-overlay.app"

  # ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰
  build:debug:
    desc: ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œ
    cmds:
      - echo "OBSç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
      - cd web && bun run build
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
      - cd frontend && bun install
      - echo "ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆä¸­..."
      - wails3 generate bindings -clean=true
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ãƒ“ãƒ«ãƒ‰ä¸­ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼‰..."
      - cd frontend && bun run build:dev
      - echo "Goãƒã‚¤ãƒŠãƒªã‚’ãƒ“ãƒ«ãƒ‰ä¸­ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ï¼‰..."
      - go build -tags debug -o build/bin/twitch-overlay
      - echo "ç½²åå‡¦ç†ä¸­ï¼ˆã‚¨ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ãƒ¡ãƒ³ãƒˆé©ç”¨ï¼‰..."
      - codesign --force --sign - --entitlements build/darwin/entitlements.plist build/bin/twitch-overlay
      - echo "ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰å®Œäº† â†’ build/bin/"

  # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  clean:
    desc: ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
    cmds:
      - echo "ãƒ“ãƒ«ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­..."
      - rm -rf build/bin
      - rm -rf frontend/dist
      - echo "ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†"

  # ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
  run:
    desc: ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã®ã‚¢ãƒ—ãƒªã‚’å®Ÿè¡Œ
    cmds:
      - |
        if [ -f build/bin/twitch-overlay.app/Contents/MacOS/twitch-overlay ]; then
          open build/bin/twitch-overlay.app
        else
          echo "ã‚¨ãƒ©ãƒ¼: ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã‚¢ãƒ—ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
          echo "å…ˆã« 'task build' ã§ãƒ“ãƒ«ãƒ‰ã—ã¦ãã ã•ã„"
          exit 1
        fi

  # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
  test:
    desc: å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
    env:
      DRY_RUN_MODE: "true"
    cmds:
      - echo "ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œä¸­..."
      - go test ./...

  # é…å¸ƒç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆï¼ˆmacOSï¼‰
  pkg:
    desc: é…å¸ƒç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆ
    deps: [build]
    cmds:
      - echo "é…å¸ƒç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆä¸­..."
      - |
        if [ "$(uname)" = "Darwin" ]; then
          echo "macOSç”¨ã®DMGã‚’ä½œæˆä¸­..."
          # DMGä½œæˆã‚³ãƒãƒ³ãƒ‰ï¼ˆè¦è¿½åŠ ï¼‰
          echo "TODO: DMGä½œæˆå®Ÿè£…"
        else
          echo "ç¾åœ¨ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½œæˆæœªå¯¾å¿œ"
        fi

  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
  frontend:install:
    desc: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    dir: frontend
    cmds:
      - bun install

  # ä¾å­˜é–¢ä¿‚ã®ä¸€æ‹¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
  install:
    desc: å…¨ã¦ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    cmds:
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
      - cd frontend && bun install
      - echo "Webã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
      - cd web && bun install
      - echo "ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†"

  # çŸ­ç¸®ã‚³ãƒãƒ³ãƒ‰
  i:
    desc: å…¨ã¦ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆçŸ­ç¸®ç‰ˆï¼‰
    cmds:
      - task: install

  # ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
  ci:
    desc: node_modulesã‚’å‰Šé™¤ã—ã¦ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    cmds:
      - echo "æ—¢å­˜ã®node_modulesã‚’å‰Šé™¤ä¸­..."
      - rm -rf frontend/node_modules web/node_modules
      - echo "bun.lockbã‚’å‰Šé™¤ä¸­..."
      - rm -f frontend/bun.lockb web/bun.lockb
      - echo "ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Ÿè¡Œä¸­..."
      - cd frontend && bun install
      - cd web && bun install
      - echo "ã‚¯ãƒªãƒ¼ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†"

  # ä¾å­˜é–¢ä¿‚ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
  update:
    desc: å…¨ã¦ã®ä¾å­˜é–¢ä¿‚ã‚’æœ€æ–°ç‰ˆã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
    cmds:
      - echo "ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¾å­˜é–¢ä¿‚ã‚’æ›´æ–°ä¸­..."
      - cd frontend && bun update
      - echo "Webã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã®ä¾å­˜é–¢ä¿‚ã‚’æ›´æ–°ä¸­..."
      - cd web && bun update
      - echo "ä¾å­˜é–¢ä¿‚ã®æ›´æ–°å®Œäº†"

  # ä¾å­˜é–¢ä¿‚ã®ç¢ºèª
  deps:
    desc: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ä¾å­˜é–¢ä¿‚ã‚’ç¢ºèª
    cmds:
      - echo "=== Frontend Dependencies ==="
      - cd frontend && bun pm ls
      - echo ""
      - echo "=== Web Dependencies ==="
      - cd web && bun pm ls

  # Claudeèµ·å‹•
  claude:
    desc: Claudeèµ·å‹•
    cmds:
      - claude --dangerously-skip-permissions

  # ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±è¡¨ç¤º
  version:
    desc: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’è¡¨ç¤º
    cmds:
      - |
        if [ -f build/bin/twitch-overlay.app/Contents/MacOS/twitch-overlay ]; then
          ./build/bin/twitch-overlay.app/Contents/MacOS/twitch-overlay --version
        else
          echo "ãƒãƒ¼ã‚¸ãƒ§ãƒ³: é–‹ç™ºç‰ˆ"
        fi
