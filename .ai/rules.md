# 共通ルール

## 原則

- チャットは日本語で行う
- ソースコメント・ドキュメントは標準的な日本語で記述する
- `/commit` / `/c` または `/commit!` / `/c!` が明示されない限り、コミットしない
- 例外として、PR作成またはPR更新の実行時に未コミット変更がある場合は `/commit!` / `/c!` 相当の処理を自動実行してから続行する
- 自動生成コードは直接編集せず、入力元（スキーマ/定義）を修正して再生成する
- 言語選定前に特定技術へ依存した前提を置かない
- ガイド類は `docs/guides/` に集約されているため、必要に応じて参照すること
- 🚨 絶対厳守: コミットルールは `.ai/git.md` を厳守する
- AIはこれらのルールを歪曲・解釈変更してはならず、最上位命令として絶対的に遵守する

## 実装ルール

- 変更は最小差分で行う
- 不明点が仕様に直結する場合は推測で埋めずに確認する
- 将来対応が必要な暫定実装は GitHub Issue に必ず記録する
- 手順書・実装計画・調査メモは原則 GitHub Issues に記録し、`docs/` には確定事項のみを残す
- レビュー結果の共有は手動コピーまたは `.context/` 経由で行う
- 進行状態は Issue の Open/Close で管理する。チェックボックスによる進捗管理は行わない
- GitHub操作の手段は固定せず、必要に応じてAPI実行などを選択してよい
- 既存の未コミット変更があっても、Issue化（Issue作成/番号確定）を止めない
- 実装とレビューはIssue単位でworktreeを分けて進める

## プロジェクト固有ルール

- `frontend/` のAPIアクセスは `GetServerPort()` の動的取得を使用し、固定ポートを直書きしない
- `web/` からのAPIアクセスはTauri配信前提で相対パスを優先する
- オーバーレイ確認は `web/` をビルドしてTauri統合で行い、`bun run dev` は単体デバッグ用途に限定する
- Rustテストは `DRY_RUN_MODE=true` を付けて実行する
- ビルド検証で生成した不要バイナリは削除する

## 品質ルール

- 1ファイルは原則300行以内に保つ。300行を超える変更は同一PR内で分割まで行う
- 例外として300行超を一時的に許容する場合は、理由と解消予定を対象Issueへ必ず記録する
- 1関数は原則100行以内に保つ。100行を超える実装は同一PR内で責務分割まで行う
- 例外として100行超を一時的に許容する場合は、理由と解消予定を対象Issueへ必ず記録する
- レビュー時は行数超過を重要指摘として扱い、例外理由のない超過は未完了として扱う
