# プロジェクト構成

## ディレクトリ構成
- **`web/`** - オーバーレイ用フロントエンド
  - ビルドして`dist/`に出力される
  - Wailsの埋め込みアセットとして配信
  - `.env`のポート設定（3456）は**単体デバッグ用のみ**
  - 通常はビルド後にWailsから配信される

- **`frontend/`** - Wails Settings画面用フロントエンド
  - Wailsアプリのメインフロントエンド（設定画面）
  - `GetServerPort()`でGoから動的にバックエンドポートを取得
  - APIアクセス時は必ず動的ポート取得を使用

- **`internal/`** - Goバックエンド
  - Webサーバー、API、プリンター制御など
  - ポートは設定から動的に決定（デフォルト: 8080）

## 開発フロー

### オーバーレイの開発
1. **変更時のビルドと確認**
   ```bash
   cd web && bun run build  # オーバーレイをビルド
   task dev                 # Wailsで統合動作確認
   ```

2. **単体デバッグ（特殊な場合のみ）**
   ```bash
   cd web && bun run dev    # localhost:5174で単体起動
   # この場合は.envのVITE_BACKEND_PORT（3456）を使用
   ```

### Settings画面の開発
```bash
task dev  # Wailsアプリとして起動して確認
```

## 重要な注意事項
- **オーバーレイ（web/）は単体では正常動作しない**
  - 必ずビルドしてWailsに組み込んで動作確認する
  - `bun run dev`での単体起動はデバッグ目的のみ

- **APIポートの扱い**
  - frontend/: `GetServerPort()`で動的取得（必須）
  - web/: Wails経由で配信されるため相対パス使用
  - 直接8080を指定しない
