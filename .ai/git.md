# Gitコミットルール

## 🚨 絶対厳守: コミット制限

- `/commit` / `/c` または `/commit!` / `/c!` の明示がない限り、コミットしない
- 「OK」「進めて」「PR作って」「pushして」などの曖昧な指示ではコミットしない
- ユーザー明示指示がない `git commit --amend` は実行しない
- コミットに Claude 共著フッターを追加しない
- コミット開始の条件は、ユーザー最新指示に `/commit` 系コマンドが明示されていること
- `/commit` / `/commit!` の実行中に発生した確認への返答は、同一手順内の継続指示として扱う

## コミットメッセージフォーマット

- 形式: `絵文字 scope: 説明`
- 説明は日本語で簡潔に書く
- scopeは変更対象に合わせて選ぶ（例: `docs` / `app` / `root`）
- 完全な絵文字リストは `docs/guides/CODING_STANDARDS.md` を参照する

### 例

- `✨ docs: 初期ガイドを追加`
- `🐛 app: APIエラーハンドリングを修正`
- `♻️ root: テンプレート構成を簡素化`

## コミット運用（`/commit` / `/commit!`）

### トリガー

- `/commit` / `/c`
- `/commit!` / `/c!`

### 共通ルール

- どちらも `git add -A` でステージングしてから処理する
- ステージング実行前の可否はユーザーに確認しない
- ステージ後に `git diff --cached --name-only` をユーザーに提示して対象ファイルを確認する
- ステージ対象に意図しない変更がある場合は、コミット前にユーザーへ報告する

### ステージング

1. `git add -A` を実行する
2. `git diff --cached --name-only` を表示して対象を確認する

### `/commit`（確認あり）

1. 変更内容に基づき、コミットメッセージ候補を3つ提示する
2. ユーザーが選んだ候補でコミットする

### `/commit!`（確認なし）

1. 変更内容に基づき、コミットメッセージ候補を3つ生成する
2. ステージ対象に意図しない変更がある場合は、コミット前に必ずユーザーへ報告し、同一手順内で継続可否を確認する
3. 継続指示がある場合は、ユーザー確認なしで先頭候補を使って即コミットする

## ブランチ・worktree運用

- `develop` を基点にIssue単位のブランチを作成する
- Issue単位で専用worktreeを作成し、作業の混線を防ぐ
- レビューや検証で分離が必要な場合は、追加worktreeを作成して確認する
- `git rev-parse --abbrev-ref HEAD` の結果が `develop` の場合、コミットせず作業ブランチへ切り替える

## PR運用

- 1Issue 1PRを基本とする
- 1PRの変更は小さく保ち、段階的に適用する
- PRのbaseブランチは `develop` とする
- PR本文には対象Issueへの参照を記載する
- `Closes` は作業対象のサブIssue番号を記載する（親Issueではなくサブ）
- `Refs` は親Issueや関連Issueを記載し、共有ライブラリ変更時は相互Issueを明示する
- `develop` から `main` への反映は `.claude/commands/merge-to-main.md` に従う
